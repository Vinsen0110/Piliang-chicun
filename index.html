<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kittyå…¬ä¸»å›¾ç‰‡æ‰¹é‡ç¼©æ”¾å±‹</title>
    <link rel="icon" type="image/png" href="kitty.png">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        /* --- æ•´ä½“é£æ ¼å®šä¹‰ --- */
        :root {
            --main-pink: #FFB6C1; /* æµ…ç²‰ */
            --hot-pink: #FF69B4;  /* çƒ­ç²‰ */
            --dark-pink: #DB7093; /* æ·±ç²‰ */
            --bg-pink: #FFF0F5;   /* èƒŒæ™¯æ·¡ç²‰ */
        }

        /* è‡ªå®šä¹‰é¼ æ ‡æŒ‡é’ˆ (å°è¯•åŠ è½½å¯çˆ±çš„å…‰æ ‡) */
        body {
            font-family: 'Comic Sans MS', 'å¹¼åœ†', 'å¾®è½¯é›…é»‘', cursive, sans-serif; /* ä½¿ç”¨å¯çˆ±çš„å­—ä½“ */
            background-color: var(--bg-pink);
            /* æ·»åŠ å¯çˆ±çš„èƒŒæ™¯çº¹ç† */
            background-image: radial-gradient(var(--main-pink) 15%, transparent 16%),
                              radial-gradient(var(--main-pink) 15%, transparent 16%);
            background-size: 60px 60px;
            background-position: 0 0, 30px 30px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            /* å¤‡ç”¨æ–¹æ¡ˆï¼šå¦‚æœæ‰¾ä¸åˆ°Kittyå…‰æ ‡ï¼Œä½¿ç”¨é»˜è®¤çš„ï¼Œä½†å°½é‡å°è¯•åŠ è½½ */
            cursor: url('https://cdn.custom-cursor.com/db/cursor/32/hello_kitty_cursor.png'), auto;
        }

        /* ä¸»å®¹å™¨å¡ç‰‡ */
        .container {
            background: #fff;
            padding: 35px;
            border-radius: 30px; /* è¶…å¤§åœ†è§’ */
            box-shadow: 0 8px 25px rgba(255, 105, 180, 0.3); /* ç²‰è‰²æŠ•å½± */
            width: 480px;
            text-align: center;
            border: 4px solid var(--main-pink); /* ç²‰è‰²è¾¹æ¡† */
            position: relative;
            overflow: hidden;
        }
        
        /* é¡¶éƒ¨è£…é¥°æ¡ */
        .container::before {
            content: 'ğŸ€';
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 24px;
        }
        .container::after {
            content: 'ğŸ€';
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 24px;
        }

        /* Kitty Logo */
        .kitty-logo {
            width: 120px;
            height: auto;
            margin-bottom: 10px;
            /* ç»™å›¾ç‰‡åŠ ä¸ªå¯çˆ±çš„æ™ƒåŠ¨åŠ¨ç”» */
            animation: float 3s ease-in-out infinite;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        h2 {
            color: var(--hot-pink);
            margin-bottom: 25px;
            text-shadow: 2px 2px 0px #FFF, 3px 3px 0px var(--main-pink);
            font-size: 28px;
        }

        /* è¾“å…¥æ¡†ç»„ */
        .input-group {
            margin-bottom: 18px;
            text-align: left;
            background: var(--bg-pink);
            padding: 10px 15px;
            border-radius: 15px;
            border: 2px solid var(--main-pink);
        }
        label {
            display: block;
            margin-bottom: 8px;
            color: var(--dark-pink);
            font-weight: bold;
        }
        label::before {
            content: 'ğŸŒ¸ ';
        }
        input[type="number"] {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--main-pink);
            border-radius: 10px;
            box-sizing: border-box;
            font-size: 16px;
            color: var(--dark-pink);
            outline: none;
            transition: all 0.3s;
        }
        input[type="number"]:focus {
            border-color: var(--hot-pink);
            box-shadow: 0 0 8px var(--main-pink);
        }

        /* --- æ–°å¢ï¼šå¿«æ·æŒ‰é’®åŒºåŸŸæ ·å¼ --- */
        .preset-area {
            margin-bottom: 20px;
            display: flex;
            justify-content: center;
            gap: 10px;
            align-items: center;
        }
        .preset-label {
            color: var(--dark-pink);
            font-weight: bold;
            font-size: 14px;
        }
        .preset-btn {
            /* ç»§æ‰¿éƒ¨åˆ†ä¸»æŒ‰é’®æ ·å¼ä½†åšå°ä¸€ç‚¹ */
            background: linear-gradient(to bottom, #ff9ec6, #DB7093);
            color: white;
            border: none;
            padding: 8px 15px;
            font-size: 14px;
            font-weight: bold;
            border-radius: 20px;
            cursor: pointer;
            width: auto; /* ä¸å æ»¡å…¨å®½ */
            box-shadow: 0 3px 8px rgba(255, 105, 180, 0.3);
            transition: all 0.2s;
        }
        .preset-btn:hover {
            transform: translateY(-2px);
            background: linear-gradient(to bottom, #ff7ac1, #e0608c);
        }
        .preset-btn:active {
            transform: scale(0.95);
        }

        /* æ–‡ä»¶ä¸Šä¼ åŒºåŸŸ */
        .file-area {
            border: 3px dashed var(--hot-pink);
            padding: 25px;
            border-radius: 20px;
            margin: 25px 0;
            background: #fff5f8;
            cursor: url('https://cdn.custom-cursor.com/db/pointer/32/hello_kitty_pointer.png'), pointer; /* æŒ‡å‘é“¾æ¥æ—¶çš„å…‰æ ‡ */
            transition: all 0.3s;
            color: var(--dark-pink);
            font-weight: bold;
        }
        .file-area:hover {
            border-color: var(--dark-pink);
            background: #ffe4ef;
            transform: scale(1.02); /* è½»å¾®æ”¾å¤§ */
        }
        .file-area p::before {
            content: 'ğŸ ';
            font-size: 24px;
        }

        /* --- æ ¸å¿ƒäº¤äº’æŒ‰é’® (é‡ç‚¹ç¾åŒ–) --- */
        button.main-btn {
            /* ç²‰è‰²æ¸å˜èƒŒæ™¯ */
            background: linear-gradient(to bottom, var(--hot-pink), var(--dark-pink));
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            font-weight: bold;
            border-radius: 50px; /* èƒ¶å›Šå½¢çŠ¶ */
            cursor: url('https://cdn.custom-cursor.com/db/pointer/32/hello_kitty_pointer.png'), pointer;
            width: 100%;
            box-shadow: 0 5px 15px rgba(255, 105, 180, 0.4);
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); /* æœ‰å¼¹æ€§çš„è¿‡æ¸¡ */
            position: relative;
            overflow: hidden;
        }
        
        /* æŒ‰é’®ä¸Šçš„å…‰æ³½æ•ˆæœ */
        button.main-btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 50%;
            background: rgba(255,255,255,0.2);
            border-radius: 50px 50px 0 0;
        }

        button.main-btn:hover {
             background: linear-gradient(to bottom, #ff7ac1, #e0608c);
             transform: translateY(-3px); /* æ‚¬åœä¸Šæµ® */
             box-shadow: 0 8px 20px rgba(255, 105, 180, 0.6);
        }

        /* ç‚¹å‡»æ—¶çš„Qå¼¹æ”¾å¤§æ•ˆæœ */
        button.main-btn:active {
            transform: scale(1.1) translateY(0); /* ç‚¹å‡»æ”¾å¤§! */
            box-shadow: 0 2px 5px rgba(255, 105, 180, 0.4);
            background: linear-gradient(to bottom, var(--dark-pink), var(--hot-pink)); /* ç‚¹å‡»åè‰² */
        }

        button:disabled {
            background: #ffc0cb;
            color: #fff;
            box-shadow: none;
            cursor: not-allowed;
            transform: none !important;
        }

        #status {
            margin-top: 20px;
            font-size: 16px;
            color: var(--dark-pink);
            font-weight: bold;
        }
        .tips {
            font-size: 13px;
            color: #999;
            margin-top: 20px;
            text-align: left;
            background: #fff0f5;
            padding: 10px;
            border-radius: 10px;
        }
        .tips::before {
             content: 'ğŸ± å°è´´å£«ï¼š';
             font-weight: bold;
             color: var(--hot-pink);
        }
    </style>
</head>
<body>

<div class="container">
    <img src="https://youke2.picui.cn/s1/2025/12/19/694503a8d81cb.png" alt="Hello Kitty" class="kitty-logo">
    
    <h2>ğŸ€ Hello Kitty æ”¹å›¾å±‹ ğŸ€</h2>
    
    <div class="input-group">
        <label>æƒ³è¦çš„æœ€å¤§å®½åº¦ (Width):</label>
        <input type="number" id="maxWidth" value="800">
    </div>
    <div class="input-group">
        <label>æƒ³è¦çš„æœ€å¤§é«˜åº¦ (Height):</label>
        <input type="number" id="maxHeight" value="800">
    </div>

    <div class="preset-area">
        <span class="preset-label">âœ¨ å¿«é€Ÿå˜èº«:</span>
        <button class="preset-btn" onclick="applyPreset(800, 800)">800 Ã— 800</button>
        <button class="preset-btn" onclick="applyPreset(750, 1000)">750 Ã— 1000</button>
    </div>

    <div class="file-area" onclick="document.getElementById('fileInput').click()">
        <p>ç‚¹è¿™é‡ŒæŠŠç…§ç‰‡äº¤ç»™ Kitty å§ (æ”¯æŒå¤šé€‰) âœ¨</p>
        <input type="file" id="fileInput" multiple accept="image/*" style="display:none" onchange="updateFileCount()">
    </div>
    
    <div id="fileCount" style="margin-bottom: 15px; color: var(--hot-pink); font-weight: bold;"></div>

    <button id="processBtn" class="main-btn" onclick="processImages()">ğŸ’– å¼€å§‹å˜èº«å¹¶ä¸‹è½½! ğŸ’–</button>
    
    <div id="status"></div>
    
    <div class="tips">
        Kitty ä¼šæ–½å±•é­”æ³•ï¼Œè®©å›¾ç‰‡ä¿æŒåŸæ¥çš„èº«ææ¯”ä¾‹ï¼Œç„¶åä¹–ä¹–é’»è¿›ä½ è®¾å®šçš„å¤§å°æ¡†æ¡†é‡Œå“¦ï¼ä¸ä¼šå˜èƒ–æˆ–å˜ç˜¦çš„~
    </div>
</div>

<script>
    // æ–°å¢ï¼šåº”ç”¨é¢„è®¾å°ºå¯¸çš„åŠŸèƒ½
    function applyPreset(w, h) {
        document.getElementById('maxWidth').value = w;
        document.getElementById('maxHeight').value = h;
    }

    function updateFileCount() {
        const input = document.getElementById('fileInput');
        const countDiv = document.getElementById('fileCount');
        if (input.files.length > 0) {
            countDiv.textContent = `ğŸ± å·²æ”¶åˆ° ${input.files.length} å¼ å¯çˆ±çš„å›¾ç‰‡!`;
        } else {
            countDiv.textContent = "";
        }
    }

    async function processImages() {
        const fileInput = document.getElementById('fileInput');
        const maxWidth = parseInt(document.getElementById('maxWidth').value);
        const maxHeight = parseInt(document.getElementById('maxHeight').value);
        const status = document.getElementById('status');
        const btn = document.getElementById('processBtn');

        if (fileInput.files.length === 0) {
            alert("è¿˜æ²¡é€‰æ‹©å›¾ç‰‡å‘¢ï¼ŒKitty ç­‰ä½ å“¦ï¼");
            return;
        }

        btn.disabled = true;
        btn.innerHTML = "â³ Kitty æ­£åœ¨åŠªåŠ›æ–½æ³•ä¸­...";
        status.textContent = "âœ¨ æ­£åœ¨å˜èº«ä¸­ï¼Œè¯·ç¨å€™...";

        const zip = new JSZip();
        
        // --- é€»è¾‘ä¿®æ”¹ï¼šç¡®å®šæ–‡ä»¶å¤¹åç§° ---
        // é»˜è®¤ä¸º Kittyå¤„ç†å¥½çš„å›¾ç‰‡ï¼Œå¦‚æœæœ‰æ–‡ä»¶ï¼Œåˆ™ä½¿ç”¨ç¬¬ä¸€å¼ å›¾ç‰‡çš„åç§°(å»æ‰åç¼€)
        let folderName = "Kittyå¤„ç†å¥½çš„å›¾ç‰‡";
        if (fileInput.files.length > 0) {
            const firstFileName = fileInput.files[0].name;
            // å»æ‰åç¼€åä½œä¸ºæ–‡ä»¶å¤¹å
            folderName = firstFileName.substring(0, firstFileName.lastIndexOf('.')) || firstFileName;
        }

        // åœ¨å‹ç¼©åŒ…å†…åˆ›å»ºä¸€ä¸ªä»¥è¯¥åç§°å‘½åçš„æ–‡ä»¶å¤¹
        const imgFolder = zip.folder(folderName);
        
        const promises = [];

        for (let file of fileInput.files) {
            promises.push(new Promise((resolve) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = function(event) {
                    const img = new Image();
                    img.src = event.target.result;
                    img.onload = function() {
                        let width = img.width;
                        let height = img.height;
                        let ratio = 1;

                        if (width > maxWidth || height > maxHeight) {
                            const widthRatio = maxWidth / width;
                            const heightRatio = maxHeight / height;
                            ratio = Math.min(widthRatio, heightRatio);
                            width = Math.floor(width * ratio);
                            height = Math.floor(height * ratio);
                        }

                        const canvas = document.createElement('canvas');
                        canvas.width = width;
                        canvas.height = height;
                        const ctx = canvas.getContext('2d');
                        
                        ctx.imageSmoothingEnabled = true;
                        ctx.imageSmoothingQuality = "high";
                        
                        ctx.drawImage(img, 0, 0, width, height);

                        let mimeType = file.type === 'image/jpeg' ? 'image/jpeg' : 'image/png';
                        
                        canvas.toBlob(function(blob) {
                            // å°†æ–‡ä»¶æ”¾å…¥æ–‡ä»¶å¤¹ä¸­ï¼Œè€Œä¸æ˜¯æ ¹ç›®å½•
                            imgFolder.file(file.name, blob);
                            resolve();
                        }, mimeType, 0.95);
                    };
                };
            }));
        }

        await Promise.all(promises);

        status.textContent = "ğŸ å˜èº«å®Œæˆï¼æ­£åœ¨æ‰“åŒ…ç¤¼ç‰©ç›’...";
        
        zip.generateAsync({type:"blob"}).then(function(content) {
            // ä¸‹è½½çš„æ–‡ä»¶åä¹Ÿå’Œæ–‡ä»¶å¤¹åä¸€è‡´
            saveAs(content, folderName + ".zip");
            status.innerHTML = "âœ… å®Œæˆå•¦ï¼ç¤¼ç‰©ç›’å·²ç»é€è¾¾ (å·²è‡ªåŠ¨ä¸‹è½½) ğŸ‰";
            btn.disabled = false;
            btn.innerHTML = "ğŸ’– å¼€å§‹å˜èº«å¹¶ä¸‹è½½! ğŸ’–";
        });
    }
</script>

</body>
</html>
